@model IEnumerable<SearchEngine.Models.SearchResult>
@{
    ViewData["Title"] = "Search Engine";
}

<div class="container mt-5">
    <div class="row justify-content-center">
        <div class="col-md-8">
            <h1 class="text-center mb-4">Search Engine</h1>
            
            <form method="get" asp-controller="Search" asp-action="Search" class="mb-4">
                <div class="input-group input-group-lg">
                    <input type="text" 
                           class="form-control" 
                           name="query" 
                           placeholder="Search documents..." 
                           value="@ViewBag.Query"
                           autofocus>
                    <button class="btn btn-primary" type="submit">Search</button>
                </div>
            </form>

            <div class="d-flex justify-content-between mb-3">
                <div>
                    <small class="text-muted">Documents: @ViewBag.TotalDocuments | Terms: @ViewBag.IndexedTerms</small>
                </div>
                <div>
                    <a href="@Url.Action("ViewIndex")" class="btn btn-sm btn-outline-secondary">View Index</a>
                    <a href="@Url.Action("Index", "Document")" class="btn btn-sm btn-secondary">Manage Docs</a>
                </div>
            </div>

            @if (Model != null && Model.Any())
            {
                <div class="alert alert-success mb-3">
                    Found @Model.Count() result(s) for "<strong>@ViewBag.Query</strong>"
                </div>

                @foreach (var result in Model)
                {
                    <div class="card mb-3">
                        <div class="card-body">
                            <h5 class="card-title">
                                <a href="@Url.Action("Details", "Document", new { id = result.Document.Id })">
                                    @result.Document.Title
                                </a>
                            </h5>
                            <p class="card-text">@(result.Document.Content.Length > 200 ? result.Document.Content.Substring(0, 200) + "..." : result.Document.Content)</p>
                            <div class="d-flex justify-content-between">
                                <small class="text-muted">@result.Document.DateAdded.ToLocalTime().ToString("MMM dd, yyyy")</small>
                                <span class="badge bg-primary">Score: @result.Relevance.ToString("F1")</span>
                            </div>
                        </div>
                    </div>
                }
            }
            else if (!string.IsNullOrEmpty(ViewBag.Query))
            {
                <div class="alert alert-warning">
                    No results found for "<strong>@ViewBag.Query</strong>"
                </div>
            }
        </div>
    </div>
</div>
